<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAXTech FCS - Redirecting...</title>
    <script>
        // Mobile Detection and Redirection Script
        (function() {
            // Function to detect mobile devices
            function isMobileDevice() {
                // Check user agent
                const userAgent = navigator.userAgent || navigator.vendor || window.opera;
                
                // More comprehensive mobile detection
                const mobileRegex = /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini|mobile|tablet|silk|kindle|phone/i;
                
                // Check screen size as additional validation
                const screenWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
                const isMobileScreen = screenWidth <= 768;
                
                // Check if it's a touch device
                const isTouchDevice = ('ontouchstart' in window) || 
                                    (navigator.maxTouchPoints > 0) || 
                                    (navigator.msMaxTouchPoints > 0);
                
                // Return true if mobile user agent OR mobile screen size OR touch device
                // More permissive to catch more mobile devices
                return mobileRegex.test(userAgent.toLowerCase()) || isMobileScreen || isTouchDevice;
            }
            
            // Function to get URL parameter
            function getUrlParameter(name) {
                name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
                const regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
                const results = regex.exec(location.search);
                return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
            }
            
            // Check if user forced desktop or mobile view
            const forceDesktop = getUrlParameter('desktop') === 'true';
            const forceMobile = getUrlParameter('mobile') === 'true';
            
            // Store user preference if explicitly set
            if (forceDesktop) {
                localStorage.setItem('viewPreference', 'desktop');
            } else if (forceMobile) {
                localStorage.setItem('viewPreference', 'mobile');
            }
            
            // Get stored preference
            const viewPreference = localStorage.getItem('viewPreference');
            
            // Check for specific project page parameter
            const viewProjects = getUrlParameter('projects') === 'true';
            
            // Determine where to redirect
            if (viewProjects || (!forceDesktop && (forceMobile || (isMobileDevice() && viewPreference !== 'desktop')))) {
                // Redirect to mobile project chat version
                window.location.replace('/mobile-projects.html');
            } else {
                // Continue loading desktop version
                window.location.replace('/desktop.html');
            }
        })();
    </script>
    <style>
        /* Fallback styling while redirecting */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .loading {
            text-align: center;
        }
        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 3px solid white;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="loading">
        <h2>SAXTech FCS</h2>
        <div class="spinner"></div>
        <p>Loading optimized experience...</p>
        <div style="margin-top: 2rem;">
            <p style="font-size: 0.9rem; opacity: 0.8;">Choose your view:</p>
            <div style="margin-top: 1rem;">
                <a href="/mobile-projects.html" style="display: inline-block; padding: 0.75rem 1.5rem; background: #1976d2; color: white; text-decoration: none; border-radius: 25px; margin: 0.5rem;">ðŸ“± Mobile Chat</a>
                <a href="/desktop.html" style="display: inline-block; padding: 0.75rem 1.5rem; background: #424242; color: white; text-decoration: none; border-radius: 25px; margin: 0.5rem;">ðŸ’» Desktop View</a>
            </div>
        </div>
    </div>
    
    <noscript>
        <meta http-equiv="refresh" content="0; url=/mobile-projects.html">
        <style>
            .loading { display: none; }
        </style>
        <div style="text-align: center; padding: 20px;">
            <h2>JavaScript is disabled</h2>
            <p>Redirecting to mobile site...</p>
            <p><a href="/mobile-projects.html">Click here if not redirected</a></p>
        </div>
    </noscript>
</body>
</html>
